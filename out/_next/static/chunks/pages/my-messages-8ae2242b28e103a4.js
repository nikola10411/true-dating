(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7858],{23310:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/my-messages",function(){return a(60143)}])},60143:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var n=a(85893),s=a(67294),i=a(46574),o=a(99226),r=a(15861),c=a(93946),l=a(21640),d=a(71310),h=a(93193),u=a(60075),m=a(36100),p=a(50356),f=(0,a(88169).Z)((0,n.jsx)("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 9h12v2H6V9zm8 5H6v-2h8v2zm4-6H6V6h12v2z"}),"Chat"),g=a(17866),x=a(11163),w=a(81588),y=()=>{let e=(0,x.useRouter)(),{user:t}=(0,l.a)(),[a,y]=(0,s.useState)([]),[v,_]=(0,s.useState)([]),[b,j]=(0,s.useState)(!1),[Z,k]=(0,s.useState)([]);return((0,s.useEffect)(()=>{let e=async()=>{let e=await (0,d.u)(t.email);j(!1),e.length&&_(e)};t&&(j(!0),e())},[t,t.email]),(0,s.useEffect)(()=>{if(v.length>0){let e=[];for(let a of v){let n=a.users.filter(e=>e!==t.email);e=e.concat(n)}let a=e.filter((e,t,a)=>a.indexOf(e)===t);a.length>0&&(0,h.$z)(a).then(e=>{y(e.map(e=>({id:e.id,...e.data()})))})}},[v,t.email]),(0,s.useEffect)(()=>{async function e(){let e=[];for(let n of a){let a=(0,m.IO)((0,m.hJ)(u.RZ,"messages"),(0,m.ar)("room","in",["".concat(n.email,"+").concat(t.email),"".concat(t.email,"+").concat(n.email)])),s=await (0,m.PL)(a);console.log(n.email),!1===s.empty&&e.push(n)}k(e),j(!1)}a.length>0&&(j(!0),e())},[a,t.email]),b)?(0,n.jsx)(p.Z,{}):(console.log(Z),(0,n.jsx)(i.Z,{children:(0,n.jsxs)(o.Z,{mt:8,children:[Z&&Z.length>0&&Z.map(t=>(0,n.jsxs)(o.Z,{mb:5,display:"flex",alignItems:"center",sx:e=>({backgroundColor:w.DM.lightGrey,border:"1px solid ".concat(e.palette.divider),borderRadius:e.shape.borderRadius,marginBottom:e.spacing(2),padding:e.spacing(2)}),children:[(0,n.jsx)(o.Z,{sx:e=>({minWidth:80,width:80,height:80,borderRadius:50,boxShadow:e.shadows[2],marginRight:e.spacing(2),backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"}),style:{backgroundImage:"url(".concat(t.photoURL||("M"===t.gender?"https://media.istockphoto.com/vectors/default-placeholder-man-vector-id844000458?":"https://st3.depositphotos.com/9998432/13335/v/600/depositphotos_133351974-stock-illustration-default-placeholder-woman.jpg"),")")}}),(0,n.jsx)(r.Z,{variant:"h6",sx:e=>({width:"100%",maxWidth:200,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}),children:t.firstName}),(0,n.jsx)(o.Z,{ml:"auto",children:(0,n.jsx)(c.Z,{onClick:()=>e.push({pathname:g._.messages,query:{data:JSON.stringify(t)}},g._.messages),children:(0,n.jsx)(f,{color:"primary"})})})]},t.id)),(!Z||0===Z.length)&&(0,n.jsx)(o.Z,{mb:5,display:"flex",alignItems:"center",justifyContent:"center",children:(0,n.jsx)(r.Z,{children:"You currently have no message history"})})]})}))}},71310:function(e,t,a){"use strict";a.d(t,{M:function(){return o},u:function(){return i}});var n=a(60075),s=a(36100);let i=async e=>{let t=(0,s.IO)((0,s.hJ)(n.RZ,"matches"),(0,s.ar)("users","array-contains",e)),a=(await (0,s.PL)(t)).docs.map(e=>{let t=e.data();return{...t,id:e.id}});return a.length?a:[]},o=e=>n.RZ.collection("matches").doc(e).delete()}},function(e){e.O(0,[9774,2888,179],function(){return e(e.s=23310)}),_N_E=e.O()}]);
//# sourceMappingURL=my-messages-8ae2242b28e103a4.js.map
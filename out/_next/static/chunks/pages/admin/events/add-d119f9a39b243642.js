(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4770],{43401:function(e,l,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/events/add",function(){return n(8625)}])},8625:function(e,l,n){"use strict";n.r(l),n.d(l,{default:function(){return C}});var t=n(85893),i=n(67294),a=n(84714),r=n(51750),s=n(99226),c=n(86886),d=n(46901),o=n(61903),u=n(87109),m=n(15861),h=n(50480),x=n(72852),j=n(83321),p=n(12899),g=n(72428),Z=n(5299),b=n(9763),f=n(33506),v=n(89261),y=n(33909),k=n(11163),w=n(81965),P=n(14106),R=n(50356),U=n(65442);function C(){let e=(0,k.useRouter)(),{events:l,setEvents:n}=(0,a.h)(),[C,L]=(0,i.useState)({id:"",designMyNightId:"",title:"",description:null,dateTime:null,venue:"",venueAddress:"",venueDescription:"",ticketPrice:"",menAvailableTickets:"",womenAvailableTickets:"",ageRangeFrom:"",ageRangeTo:"",featured:!1,archived:!1,showBanner:!1,banner:"",imgURL:null,imgMobileUrl:null,participants:[],discountCodes:[{percent:10,code:(0,b.Y)()},{percent:15,code:(0,b.Y)()},{percent:20,code:(0,b.Y)()}],howItWorks:{col1:{imgURL:null,description:null},col2:{imgURL:null,description:null},col3:{imgURL:null,description:null},finalNotes:null}}),[I,T]=(0,i.useState)(null),[W,E]=(0,i.useState)(null),[S,D]=(0,i.useState)(null),[_,A]=(0,i.useState)(!1),[B,V]=(0,i.useState)(C),[N,M]=(0,i.useState)(!1),O=(0,i.useCallback)(e=>{L({...C,dateTime:e?new Date(e):null})},[C]),F=(0,i.useCallback)((e,l)=>L(e=>({...e,featured:l})),[]),G=(0,i.useCallback)((e,l)=>L(e=>({...e,isSameGender:l})),[]),H=(0,i.useCallback)((e,l)=>L(e=>({...e,archived:l})),[]),q=(0,i.useCallback)((e,l)=>L(e=>({...e,showBanner:l})),[]),Y=(0,i.useCallback)(e=>{let{target:{name:l,value:n,type:t}}=e;"number"===t&&n&&(n=Number(n))<0||L({...C,[l]:n})},[C]),K=(0,i.useCallback)(e=>{let{target:{files:l}}=e;if(l&&l.length){let e=l[0];if(!(0,U.e)(e))return L(e=>({...e,imgURL:null})),E(null),scrollTop(),T("Invalid image file type!");I&&T(null),E(e),L(l=>({...l,imgURL:URL.createObjectURL(e)}))}},[I]),X=(0,i.useCallback)(e=>{let{target:{files:l}}=e;if(l&&l.length){let e=l[0];if(!(0,U.e)(e))return L(e=>({...e,imgMobileUrl:null})),D(null),scrollTop(),T("Invalid image file type!");I&&T(null),D(e),L(l=>({...l,imgMobileUrl:URL.createObjectURL(e)}))}},[I]),z=(0,i.useCallback)(e=>{e.preventDefault(),URL.revokeObjectURL(W),document.querySelector("#file-input-desktop").value="",L(e=>({...e,imgURL:null})),E(null)},[W]),J=(0,i.useCallback)(e=>{e.preventDefault(),URL.revokeObjectURL(S),document.querySelector("#file-input-mobile").value="",L(e=>({...e,imgMobileUrl:null})),D(null)},[S]),Q=(0,i.useCallback)(async()=>{let e=C.howItWorks.col1;if(e.imgURL&&e.imgURL!==B.howItWorks.col1.imgURL){let l=await fetch(e.imgURL).then(e=>e.blob()),n=new File([l],"untitled",{type:l.type});e.imgURL=await (await uploadFile(n,HOW_IT_WORKS_IMAGES_PATH)).ref.getDownloadURL()}let l=C.howItWorks.col2;if(l.imgURL&&l.imgURL!==B.howItWorks.col2.imgURL){let e=await fetch(l.imgURL).then(e=>e.blob()),n=new File([e],"untitled",{type:e.type});l.imgURL=await (await uploadFile(n,HOW_IT_WORKS_IMAGES_PATH)).ref.getDownloadURL()}let n=C.howItWorks.col3;if(n.imgURL&&n.imgURL!==B.howItWorks.col3.imgURL){let e=await fetch(n.imgURL).then(e=>e.blob()),l=new File([e],"untitled",{type:e.type});n.imgURL=await (await uploadFile(l,HOW_IT_WORKS_IMAGES_PATH)).ref.getDownloadURL()}},[C.howItWorks,B.howItWorks]),$=(0,i.useCallback)(async t=>{t.preventDefault(),I&&T(null),A(!0);try{await Q();let t=W?await (await uploadFile(W,EVENTS_IMAGES_PATH)).ref.getDownloadURL():null,i=S?await (await uploadFile(S,EVENTS_IMAGES_PATH)).ref.getDownloadURL():null,a=(await addEvent({...C,lowercaseTitle:C.title.toLowerCase(),imgURL:t,imgMobileUrl:i})).id,r={...await getEvent(a),id:a};return n([...l,r]),e.replace(routes.adminEvents)}catch(e){T(e.message),scrollTop()}A(!1)},[I,C,l,W,Q,n]),ee=(0,i.useCallback)(e=>{L(l=>({...l,description:e}))},[]),el=(0,i.useCallback)(e=>{L(l=>({...l,venueDescription:e}))},[]),en=(0,i.useCallback)(e=>{L({...C,participants:e})},[C]),et=(0,i.useCallback)(e=>L({...C,howItWorks:e}),[C]);return(0,t.jsxs)(r.default,{children:[(_||N)&&(0,t.jsx)(R.Z,{}),!N&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h2",{children:"Create Event"}),(0,t.jsx)(s.Z,{mt:2,mb:2,children:(0,t.jsxs)("form",{onSubmit:$,children:[(0,t.jsxs)(c.ZP,{container:!0,justifyContent:"space-between",spacing:2,children:[(0,t.jsxs)(c.ZP,{item:!0,container:!0,direction:"column",sm:6,spacing:2,children:[I&&(0,t.jsx)(c.ZP,{item:!0,children:(0,t.jsx)(d.Z,{severity:"error",children:I})}),(0,t.jsx)(c.ZP,{item:!0,children:(0,t.jsx)(o.Z,{defaultValue:C.title,name:"title",fullWidth:!0,variant:"outlined",label:"Event Title",required:!0,onBlur:Y})}),(0,t.jsx)(c.ZP,{item:!0,children:(0,t.jsx)(p.x,{name:"dateTime",fullWidth:!0,value:C.dateTime,onChange:O,label:"Event Date and Time",clearable:!0,inputVariant:"outlined",required:!0})}),(0,t.jsx)(c.ZP,{item:!0,children:(0,t.jsx)(o.Z,{defaultValue:C.designMyNightId,name:"designMyNightId",fullWidth:!0,variant:"outlined",label:"Design My Night Event ID",onBlur:Y})}),(0,t.jsx)(c.ZP,{item:!0,children:(0,t.jsx)(o.Z,{InputProps:{startAdornment:(0,t.jsx)(u.Z,{position:"start",children:"\xa3"}),inputProps:{min:0}},name:"ticketPrice",type:"number",fullWidth:!0,variant:"outlined",label:"Ticket Price",defaultValue:C.ticketPrice,onBlur:Y})}),(0,t.jsx)(c.ZP,{item:!0,children:(0,t.jsx)(o.Z,{InputProps:{startAdornment:(0,t.jsx)(u.Z,{position:"start",children:"\xa3"}),inputProps:{min:0}},name:"ticketPriceWithoutDiscount",type:"number",fullWidth:!0,variant:"outlined",label:"Ticket Price Without Discount",defaultValue:C.ticketPriceWithoutDiscount,onBlur:Y})}),(0,t.jsx)(c.ZP,{item:!0,children:(0,t.jsxs)(s.Z,{display:"flex",alignItems:"center",children:[(0,t.jsx)(m.Z,{tag:"h4",children:"Same Gender event?"}),(0,t.jsx)(s.Z,{ml:4,children:(0,t.jsx)(h.Z,{name:"isSameGender",label:C.isSameGender?"YES":"NO",labelPlacement:"end",checked:C.isSameGender,control:(0,t.jsx)(x.Z,{color:"primary",title:"Same Gender"}),onChange:G})})]})}),(0,t.jsx)(c.ZP,{item:!0,children:(0,t.jsx)("h4",{children:"Available Tickets"})}),(0,t.jsxs)(c.ZP,{item:!0,container:!0,children:[(0,t.jsx)(c.ZP,{item:!0,xs:5,children:(0,t.jsx)(o.Z,{name:"menAvailableTickets",fullWidth:!0,variant:"outlined",label:"Men",type:"number",defaultValue:C.menAvailableTickets,required:!0,onBlur:Y})}),(0,t.jsx)(c.ZP,{item:!0,container:!0,alignItems:"center",justifyContent:"center",xs:2,children:(0,t.jsx)("h4",{children:(0,t.jsx)(g.Z,{})})}),(0,t.jsx)(c.ZP,{item:!0,xs:5,children:(0,t.jsx)(o.Z,{name:"womenAvailableTickets",fullWidth:!0,variant:"outlined",label:"Women",type:"number",defaultValue:C.womenAvailableTickets,required:!0,onBlur:Y})})]}),(0,t.jsx)(c.ZP,{item:!0,children:(0,t.jsx)("h4",{children:"Age Range"})}),(0,t.jsxs)(c.ZP,{item:!0,container:!0,children:[(0,t.jsx)(c.ZP,{item:!0,xs:5,children:(0,t.jsx)(o.Z,{name:"ageRangeFrom",fullWidth:!0,variant:"outlined",label:"From",type:"number",defaultValue:C.ageRangeFrom,onBlur:Y})}),(0,t.jsx)(c.ZP,{item:!0,container:!0,alignItems:"center",justifyContent:"center",xs:2,children:(0,t.jsx)(Z.Z,{})}),(0,t.jsx)(c.ZP,{item:!0,xs:5,children:(0,t.jsx)(o.Z,{name:"ageRangeTo",fullWidth:!0,variant:"outlined",label:"To",type:"number",defaultValue:C.ageRangeTo,onBlur:Y})})]}),(0,t.jsx)(c.ZP,{item:!0,display:{sm:"none",xs:"block"},children:(0,t.jsx)(f.Z,{id:"file-input",onDelete:z,onUpload:K,imgURL:C.imgURL})})]}),(0,t.jsxs)(c.ZP,{item:!0,sm:6,display:{sm:"block",xs:"none"},children:[(0,t.jsxs)(s.Z,{children:[(0,t.jsx)("h4",{style:{marginBottom:"4px"},children:"Desktop Image (min 900 px width)"}),(0,t.jsx)(f.Z,{id:"file-input-desktop",onDelete:z,onUpload:K,imgURL:C.imgURL})]}),(0,t.jsxs)(s.Z,{style:{marginTop:"20px"},children:[(0,t.jsx)("h4",{style:{marginBottom:"4px"},children:"Mobile Image (max 440 px width)"}),(0,t.jsx)(f.Z,{id:"file-input-mobile",onDelete:J,onUpload:X,imgURL:C.imgMobileUrl})]})]})]}),(0,t.jsx)(s.Z,{my:4,children:(0,t.jsxs)(c.ZP,{container:!0,spacing:4,children:[(0,t.jsxs)(c.ZP,{item:!0,md:6,children:[(0,t.jsx)(s.Z,{children:(0,t.jsx)(o.Z,{name:"venue",fullWidth:!0,variant:"outlined",label:"Venue",defaultValue:C.venue,required:!0,onBlur:Y})}),(0,t.jsx)(s.Z,{mt:3,children:(0,t.jsx)(o.Z,{name:"venueAddress",fullWidth:!0,variant:"outlined",label:"Venue Address",defaultValue:C.venueAddress,onBlur:Y})})]}),(0,t.jsxs)(c.ZP,{item:!0,md:6,children:[(0,t.jsx)(s.Z,{py:2,children:(0,t.jsx)("h4",{children:"Venue Description"})}),(0,t.jsx)(v.Z,{description:(0,y.E)(C.venueDescription),onChange:el,placeholder:"Venue Description"})]})]})}),(0,t.jsx)(s.Z,{my:4,children:(0,t.jsxs)(c.ZP,{container:!0,alignItems:"center",children:[(0,t.jsx)(c.ZP,{item:!0,sm:4,children:(0,t.jsxs)(s.Z,{display:"flex",alignItems:"center",children:[(0,t.jsx)(m.Z,{tag:"h4",children:"Featured Event?"}),(0,t.jsx)(s.Z,{ml:4,children:(0,t.jsx)(h.Z,{name:"featured",label:C.featured?"YES":"NO",labelPlacement:"end",checked:C.featured,control:(0,t.jsx)(x.Z,{color:"primary",title:"Featured Event"}),onChange:F})})]})}),(0,t.jsx)(c.ZP,{item:!0,sm:4,children:(0,t.jsxs)(s.Z,{display:"flex",alignItems:"center",children:[(0,t.jsx)(m.Z,{tag:"h4",color:"primary",children:"Archived Event?"}),(0,t.jsx)(s.Z,{ml:4,children:(0,t.jsx)(h.Z,{name:"archived",label:C.archived?"YES":"NO",labelPlacement:"end",checked:C.archived,control:(0,t.jsx)(x.Z,{color:"primary",title:"Archived Event"}),onChange:H})})]})}),(0,t.jsx)(c.ZP,{item:!0,sm:4,children:(0,t.jsxs)(s.Z,{display:"flex",alignItems:"center",children:[(0,t.jsx)(m.Z,{tag:"h4",color:"primary",children:"Discounts"}),(0,t.jsx)(s.Z,{ml:2,children:C.discountCodes.map((e,l)=>(0,t.jsx)(s.Z,{mt:1,children:(0,t.jsx)(o.Z,{name:"discountCode",fullWidth:!0,variant:"outlined",label:"Discount Code(".concat(e.percent," %)"),defaultValue:e.code,onBlur:e=>handleDiscountChange(e.target.value,l)})},l))})]})})]})}),(0,t.jsx)(s.Z,{my:4,children:(0,t.jsxs)(c.ZP,{container:!0,alignItems:"center",children:[(0,t.jsx)(c.ZP,{item:!0,sm:4,children:(0,t.jsxs)(s.Z,{display:"flex",alignItems:"center",children:[(0,t.jsx)(m.Z,{tag:"h4",children:"Show Banner?"}),(0,t.jsx)(s.Z,{ml:4,children:(0,t.jsx)(h.Z,{name:"showBanner",label:C.showBanner?"YES":"NO",labelPlacement:"end",checked:C.showBanner,control:(0,t.jsx)(x.Z,{color:"primary",title:"Show Banner"}),onChange:q})})]})}),(0,t.jsx)(c.ZP,{item:!0,sm:8,children:(0,t.jsx)(o.Z,{name:"banner",fullWidth:!0,variant:"outlined",label:"Banner",type:"text",defaultValue:C.banner,onBlur:Y})})]})}),(0,t.jsxs)(s.Z,{my:4,children:[(0,t.jsx)(s.Z,{py:2,children:(0,t.jsx)("h4",{children:"Event Description"})}),(0,t.jsx)(v.Z,{description:(0,y.E)(C.description),onChange:ee})]}),(0,t.jsx)(s.Z,{my:4,children:(0,t.jsx)(w.Z,{howItWorks:C.howItWorks,onChange:et,setError:T,error:I})}),(0,t.jsx)(s.Z,{my:4,children:(0,t.jsx)(P.Z,{participants:C.participants,onChange:en,disabled:!0})}),(0,t.jsx)(s.Z,{my:4,children:(0,t.jsxs)(c.ZP,{container:!0,spacing:2,justifyContent:"flex-end",children:[(0,t.jsx)(c.ZP,{item:!0,xs:6,sm:4,md:3,children:(0,t.jsx)(j.Z,{fullWidth:!0,onClick:()=>e.push(routes.adminEvents),type:"button",color:"secondary",variant:"contained",children:"Cancel"})}),(0,t.jsx)(c.ZP,{item:!0,xs:6,sm:4,md:3,children:(0,t.jsx)(j.Z,{fullWidth:!0,disabled:_||N,type:"submit",color:"primary",variant:"contained",children:"Create Event"})})]})})]})})]})]})}}},function(e){e.O(0,[1903,7579,935,4654,6023,8070,3168,8527,9774,2888,179],function(){return e(e.s=43401)}),_N_E=e.O()}]);
//# sourceMappingURL=add-d119f9a39b243642.js.map